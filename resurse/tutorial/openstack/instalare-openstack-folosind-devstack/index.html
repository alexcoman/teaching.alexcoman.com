<!DOCTYPE html> <!--[if IE 8]> <html lang="ro" class="ie8"> <![endif]--> <!--[if IE 9]> <html lang="ro" class="ie9"> <![endif]--> <!--[if !IE]><!--> <html lang="ro"> <!--<![endif]--> <head> <title>Instalarea OpenStack folosind DevStack</title> <!-- Meta --> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" lang="ro" xml:lang="ro" content="Situl dedicat laboratoarelor susținute în cadrul Facultății de Informatică din Iași." /> <meta name="keywords" lang="en" xml:lang="en" content="Web, WWW, technology, course, Romania, Iasi, Computer Science, university, academic, information, education, school, project, lang programming, document, software, application, student, grade" /> <meta name="keywords" lang="ro" xml:lang="ro" content="Web, WWW, technologie, curs, Romania, Iasi, Informatica, universitate, academic, informatie, educatie, scoala, proiect, limbaj, programare, document, software, aplicatie, student, nota" /> <link rel="shortcut icon" href="/~alex.coman/assets/images/favicon.ico"> <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'> <!-- Global CSS --> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> <!-- Plugins CSS --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css"> <!-- Theme CSS --> <link id="theme-style" rel="stylesheet" href="/~alex.coman/assets/css/main.css"> <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script> <![endif]--> <link rel="canonical" href="https://profs.info.uaic.ro/~alex.coman/resurse/tutorial/openstack/instalare-openstack-folosind-devstack/"> <link rel="alternate" type="application/rss+xml" title="" href="/~alex.coman/feed.xml"> <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script> </head> <body > <div class="page-wrapper"> <header id="header" class="header "> <div class="container"> <div class="branding"> <h1 class="logo"> <a href="/resurse/tutorial/openstack/instalare-openstack-folosind-devstack/"> <span aria-hidden="true" class="icon fas fa-laptop"></span> <span class="text-highlight">Laboratoare</span> <span class="text">@FII</span> </a> </h1> </div> <ol class="breadcrumb"> <li><a href="//~alex.coman">Acasă</a></li> <li><a href="/~alex.coman/resurse">Resurse</a></li> <li><a href="/~alex.coman/resurse/tutorial">Tutorial</a></li> <li><a href="/~alex.coman/resurse/tutorial/openstack">Openstack</a></li> <li class="active">Instalarea OpenStack folosind DevStack</li> </ol> </div> </header> <section id="blog_post" class="blog-post-section doc-wrapper"> <div class="container"> <div id="doc-header" class="doc-header text-center"> <h1 class="doc-title" itemprop="name headline"> <i class="icon fas fa-paper-plane"></i> Instalarea OpenStack folosind DevStack </h1> <div class="meta"> Publicat de: <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Alexandru Coman</span> </span> pe <i class="fas fa-clock"></i> <time datetime="2017-05-15T12:00:00+00:00" itemprop="datePublished"> 15 mai 2017 </time> </div> </div> <div class="doc-body"> <div class="doc-content"> <div class="content-inner"> <section id="dashboards" class="doc-section"> <div class="section-block"> <p>În cadrul acestui tutorial o să vorbim despre o metodă prin care putem să pregătim un mediu de dezvoltare pentru <a href="https://www.openstack.org/">OpenStack</a> folosind utilitarul <a href="https://docs.openstack.org/developer/devstack/">DevStack</a>.</p> <!--more--> <p><strong>Avertisment</strong>: Mediul pregătit folosind <a href="https://docs.openstack.org/developer/devstack/">DevStack</a> nu este unul persistent, utilitarul are ca scop pregătirea unui mediu de dezvoltare într-un timp foarte scurt ce facilitează utilizatorilor posibilitatea de a interacționa cu OpenStack și de a testa funcționalități experimentale. Această metodă nu este destinată pregătirii unui mediu de producție.</p> <h2 id="resurse-necesare">Resurse necesare</h2> <p>Pentru pregătirea mediului de dezvoltare o să avem nevoie de o mașină virtuală cu sistemul de operare <a href="https://www.centos.org/">CentOS 7</a>. În tutorialul <em><a href="/~alex.coman/resurse/tutorial/virtualbox/instalare-centos-7/">Instalarea sistemului de operare CentOS 7</a></em> puteți găsi toți pașii pe care trebuie să îi urmați pentru pregătirea acesteia.</p> <h2 id="pregătirea-mașinii-virtuale">Pregătirea mașinii virtuale</h2> <h3 id="modulul-selinux">Modulul SELinux</h3> <p>Pentru a ușura pregătirea mediului o să începem prin a dezactiva modulul <strong>SELinux</strong>(<em>Security-Enhanced Linux</em>) din cadrul nucleului de Linux.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"SELINUX=disabled"</span> <span class="o">&gt;</span> /etc/sysconfig/selinux
~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"SELINUXTYPE=minimum"</span> <span class="o">&gt;&gt;</span> /etc/sysconfig/selinux
</code></pre></div></div> <p><strong>Avertisment</strong>: acest lucru va scădea securitatea sistemului de operare.</p> <p>Pentru ca modificările asupra <em>SELinux</em> să aibă efect, va trebui să repornim sistemul de operare.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>reboot
</code></pre></div></div> <h3 id="configurația-rețelei">Configurația rețelei</h3> <p>Înainte de a trece la pasul următor, va trebui să verificăm care este starea rețelelor din cadrul sistemului de operare.</p> <p>Pentru a vedea conexiunile care disponibile putem să rulăm comanda următoare:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>nmcli con s
</code></pre></div></div> <p>În cadrul mașinii pregătite în cadrul tutorialul <em><a href="/~alex.coman/resurse/tutorial/virtualbox/instalare-centos-7/">Instalarea sistemului de operare CentOS 7</a></em> comanda de mai sus a afișat pe ecran:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME    UUID                                  TYPE            DEVICE
eth0    c7b645b7-4647-49ea-a2bf-d5dbeea6db89  802-3-ethernet  enp0s3
eth1    0608fbce-9e8c-40fa-aeef-6e418c8ace10  802-3-ethernet  enp0s8
</code></pre></div></div> <p>În cazul în care conexiunile respective nu sunt active putem folosi comanda <code class="highlighter-rouge">nmcli con up &lt;nume_conexiune&gt;</code>.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># De exemplu
~ $ nmcli con up eth1
</code></pre></div></div> <p>Pasul următor este să configurăm static interfața pe care o să o folosim pentru a interacționa cu Horizon, interfața web prin intermediul căreia putem interacționa cu OpenStack.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>nmcli con m eth1 <span class="se">\</span>
    ipv4.method manual <span class="se">\</span>
    ipv4.addresses 192.168.56.101/24 <span class="se">\</span>
    ipv4.gateway 192.168.56.1
~ <span class="nv">$ </span>nmcli con down eth1 <span class="o">&amp;&amp;</span> nmcli con up eth1
</code></pre></div></div> <p>Pentru a vizualiza modificările făcute, putem rula comanda următoare:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>ip <span class="nt">-4</span> a s
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic enp0s3
       valid_lft 84730sec preferred_lft 84730sec
3: enp0s8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    inet 192.168.56.101/24 brd 192.168.56.255 scope global dynamic enp0s8
       valid_lft 743sec preferred_lft 743sec
</code></pre></div></div> <h2 id="utilitarul-devstack">Utilitarul DevStack</h2> <h3 id="adăugarea-unui-utilizator">Adăugarea unui utilizator</h3> <p>Nu este recomandat să rulăm, utilitarul <a href="https://docs.openstack.org/developer/devstack/">DevStack</a> în contextul utilizatorului <em>root</em>. Pentru a putea să îl rulăm avem nevoie de un utilizator nou, care să aibă privilegii de administrator. În cazul în care ați adăugat un utilizator nou în timpul instalării sistemului de operare, acest pas nu mai este necesar.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>useradd <span class="nt">-s</span> /bin/bash <span class="nt">-d</span> /opt/stack <span class="nt">-m</span> stack
</code></pre></div></div> <h3 id="privilegii-de-administrare">Privilegii de administrare</h3> <p>Oferim privilegii de administrare utilizatorului creat și îi dăm posibilitatea de a rula comenzi elevate fără a i se cere parola.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"stack ALL=(ALL) NOPASSWD: ALL"</span> <span class="o">&gt;&gt;</span> /etc/sudoers
</code></pre></div></div> <h3 id="instalarea-openstack">Instalarea OpenStack</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>su stack    <span class="c"># Schimbăm utilizatorul din root în stack</span>
~ <span class="nv">$ </span><span class="nb">cd</span>          <span class="c"># Schimbăm directorul de lucru</span>
~ <span class="nv">$ </span>git clone https://git.openstack.org/openstack-dev/devstack
</code></pre></div></div> <p>După ce am făcut o copie locală a utilitarului <a href="https://docs.openstack.org/developer/devstack/">DevStack</a> mai trebuie să adăugăm un fișier de configurare (numit <em>local.conf</em>) în care putem specifica modul în care dorim ca <a href="https://www.openstack.org/">OpenStack</a> să fie instalat.</p> <p>În cadrul acestui tutorial vom opta spre a instala toate componentele OpenStack în cadrul aceleași mașini virtuale.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span><span class="nb">cd </span>devstack
~ <span class="nv">$ </span>vi local.conf
</code></pre></div></div> <p>Un exemplu de fișier de configurare pentru configurația mașinii virtuale curente și a rețelelor din aceasta, ar putea fi:</p><pre><code class="language-[[local|localrc]]">HOST_IP=192.168.56.101
FLOATING_RANGE=192.168.56.101/27
FIXED_RANGE=10.10.10.0/24
FIXED_NETWORK_SIZE=256
FLAT_INTERFACE=eth0
ADMIN_PASSWORD=supersecret
DATABASE_PASSWORD=iheartdatabases
RABBIT_PASSWORD=flopsymopsy
SERVICE_PASSWORD=iheartksl
[[local|localrc]]
FLOATING_RANGE=192.168.1.224/27
FIXED_RANGE=10.11.12.0/24
FIXED_NETWORK_SIZE=256
FLAT_INTERFACE=enp0s8
ADMIN_PASSWORD=supersecret
DATABASE_PASSWORD=iheartdatabases
RABBIT_PASSWORD=flopsymopsy
SERVICE_PASSWORD=iheartksl
</code></pre><p>După ce am specificat modul în care dorim să fie pregătit mediul de dezvoltare cu OpenStack, putem să începem instalarea:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>./stack
</code></pre></div></div> <p>După aproximativ 15 minute, instalarea ar trebui să se finalizeze și să primim un raport cu detalii despre mediul creat.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">=========================</span>
DevStack Component Timing
<span class="o">=========================</span>
Total runtime    994

run_process       27
test_with_retry    4
pip_install      169
wait_for_service  20
yum_install       33
<span class="o">=========================</span>



This is your host IP address: 192.168.56.101
This is your host IPv6 address: ::1
Horizon is now available at http://192.168.56.101/dashboard
Keystone is serving at http://192.168.56.101/identity/
The default <span class="nb">users </span>are: admin and demo
The password: supersecret
Services are running under systemd unit files.
For more information see:
https://docs.openstack.org/developer/devstack/systemd.html
2017-05-15 13:47:09.207 | stack.sh completed <span class="k">in </span>994 seconds.
</code></pre></div></div> <h2 id="după-instalarea">După instalarea</h2> <p>Pentru a putea accesa interfața web (<em>Horizon</em>) din afara mașinii virtuale, va trebui să adăugăm două reguli noi în fișierul <em>/etc/sysconfig/iptables</em>. Cele două reguli vor permite conexiuni din exterior pe porturile <em>80</em> și respectiv <em>443</em>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 443 <span class="nt">-j</span> ACCEPT
<span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 80 <span class="nt">-j</span> ACCEPT
</code></pre></div></div> <p>Pentru ca modificările făcute să aibă efect, va trebuie să repornim serviciul <em>iptables</em>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>service iptables restart
</code></pre></div></div> <p class="center"><img src="/~alex.coman/assets/img/devstack/openstack.png" alt="Am terminat" /></p> </div> </section> </div> </div> <div class="toc-sidebar hidden-xs"> <nav id="toc-nav"> <ul id="toc-menu" class="toc-menu nav nav-stacked" data-spy="affix" data-offset-top="180"> <li><a class="scrollto" href="#resurse-necesare">Resurse necesare</a> </li> <li><a class="scrollto" href="#pregătirea-mașinii-virtuale">Pregătirea mașinii virtuale</a> <ul class="toc-sub-menu nav nav-stacked"> <li><a class="scrollto" href="#modulul-selinux">Modulul SELinux</a> </li> <li><a class="scrollto" href="#configurația-rețelei">Configurația rețelei</a> </li></ul></li> <li><a class="scrollto" href="#utilitarul-devstack">Utilitarul DevStack</a> <ul class="toc-sub-menu nav nav-stacked"> <li><a class="scrollto" href="#adăugarea-unui-utilizator">Adăugarea unui utilizator</a> </li> <li><a class="scrollto" href="#privilegii-de-administrare">Privilegii de administrare</a> </li> <li><a class="scrollto" href="#instalarea-openstack">Instalarea OpenStack</a> </li></ul></li> <li><a class="scrollto" href="#după-instalarea">După instalarea</a> </li> </ul> </nav> </div> </div> </div> </section> </div> <footer class="footer text-center"> <div class="container-fluid"> <div class="row"> <div class="col-md-2 col-xs-6"> <small class="copyright"> Bazat pe <a href="https://github.com/xriley/PrettyDocs-Theme" target="_blank">PrettyDocs</a>, dezvoltat de <a href="http://themes.3rdwavemedia.com/" target="_blank">Xiaoying Riley</a>. </small> </div> <div class="offset-md-2 col-md-8 col-xs-6"> <small> Ultima actualizare: 15 februarie 2018 / <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Conținut licențiat sub termenii Attribution-NonCommercial-ShareAlike 4.0 International">CC</a> <br/><a href="https://profs.info.uaic.ro/~alex.coman/" title="Spre situl Web al titularului laboratorului Alexandru Coman.">Alexandru Coman</a> </small> </div> </div> </div> </footer> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.2/jquery.matchHeight-min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/prism.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js"></script> <script src="/~alex.coman/assets/js/main.js"></script> </body> </html>
